# Cloud Decision Record (CDR) - Phase 2 착수 전 필수 결정

## 1) 이 문서의 목적
- "어떤 클라우드를 쓸지"를 감으로 정하지 않고, 기준표로 결정하기 위한 문서입니다.
- 비개발자도 비교하고 승인할 수 있도록 쉽게 정리했습니다.

## 2) 왜 지금 결정해야 하나?
- Phase 2는 DB 전환 단계입니다.
- 이때 클라우드/DB를 늦게 바꾸면, 이미 만든 코드를 다시 뜯어야 해서 비용이 큽니다.

## 3) 현재 전제
- 백엔드 서버는 현재 Render에서 운영 중
- 분석 API 라우트는 이미 운영 중 (`/analyze`, `/analyze/label`, `/lookup/barcode`)
- 앞으로 로그인 + 사용자 데이터 서버 저장이 필요

## 4) 후보안 (초기)

### 옵션 A. Render 유지 + Managed PostgreSQL (권장 시작안)
- 설명:
  - 현재 운영 중인 Render를 유지하고, DB만 관리형 PostgreSQL로 붙입니다.
- 장점:
  - 현재 구조와 가장 자연스럽게 연결
  - 초기 전환 속도 빠름
  - 운영 복잡도 상대적으로 낮음
- 단점:
  - 초대형 트래픽에서 세밀한 튜닝 여지 제한 가능

### 옵션 B. GCP 중심 전환 (Cloud Run + Cloud SQL)
- 설명:
  - 서버/DB를 GCP 관리형 서비스로 재구성합니다.
- 장점:
  - 구글 생태계 연동 유리
  - 확장성/관측성 도구 풍부
- 단점:
  - 초기 설정 복잡도 상승
  - 학습/운영 비용 증가 가능

### 옵션 C. AWS 중심 전환 (ECS/Lambda + RDS)
- 설명:
  - 서버/DB를 AWS 표준 조합으로 구성합니다.
- 장점:
  - 대규모 운영 사례 많음
  - 고급 네트워크/보안 옵션 풍부
- 단점:
  - 운영 난이도 높음
  - 초기 속도 저하 가능

## 5) 비교 기준표 (비개발자용)
- 1점(낮음) ~ 5점(높음)

| 기준 | 옵션 A (Render+Managed PG) | 옵션 B (GCP) | 옵션 C (AWS) |
|---|---:|---:|---:|
| 초기 구축 속도 | 5 | 3 | 2 |
| 초기 운영 난이도 | 4 | 3 | 2 |
| 장기 확장성 | 3 | 5 | 5 |
| 팀 학습 부담 | 4 | 3 | 2 |
| 현재 시스템 연속성 | 5 | 3 | 2 |
| 총점 (초기 기준) | 21 | 17 | 13 |

## 6) CTO 권고안
- 1차(지금): **옵션 A**로 빠르게 Phase 2 완료
- 2차(트래픽 증가 시): 옵션 B 또는 C로 이전 가능한 구조 유지
- 핵심 원칙:
  - 앱/서버 코드에서 벤더 종속 로직 최소화
  - DB 접근은 Repository/Service 계층으로 추상화
  - 환경변수/시크릿/스토리지 adapter 분리

## 7) 의사결정 체크리스트 (승인용)
- [ ] 초기 구축 속도를 우선한다
- [ ] 현재 팀 운영 난이도를 고려한다
- [ ] 6~12개월 내 예상 트래픽 기준을 확인했다
- [ ] 이전(Migration) 전략 문서가 있다
- [ ] 장애 시 롤백 경로가 명확하다

## 8) 결정 기록
- 결정일: YYYY-MM-DD
- 결정자: (PM/CTO/Lead)
- 선택 옵션: (A/B/C)
- 선택 이유(3줄 이내):
  1.
  2.
  3.
- 재검토 시점: YYYY-MM-DD

## 9) 연결 문서
- [Master Plan](./master-plan.md)
- [Phase 2 실행표](./phase-2-cloud-db-execution.md)
- [API 계약 기준서](../contracts/api-contracts.md)

---

문서 버전: v1.0  
소유: CTO/PM 공동  
최종 수정: 2026-02-19
